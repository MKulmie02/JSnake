<!DOCTYPE html>
<html>
<head>
<title>JSnake</title>
<style type="text/css">

.gameRow { height: 102px;width:816px; }
body, #gameArea { width:816px;height;816px; }
.gameCol { height: 100px; float: left; width: 100px; background-color: #eee; border: 1px solid #eee; }

</style>
</head>
<body>

<div id="gameArea">

<div class="gameRow">
 <div class="gameCol" id="r0c0"></div>
 <div class="gameCol" id="r0c1"></div>
 <div class="gameCol" id="r0c2"></div>
 <div class="gameCol" id="r0c3"></div>
 <div class="gameCol" id="r0c4"></div>
 <div class="gameCol" id="r0c5"></div>
 <div class="gameCol" id="r0c6"></div>
 <div class="gameCol" id="r0c7"></div>
</div>
<div class="gameRow">
 <div class="gameCol" id="r1c0"></div>
 <div class="gameCol" id="r1c1"></div>
 <div class="gameCol" id="r1c2"></div>
 <div class="gameCol" id="r1c3"></div>
 <div class="gameCol" id="r1c4"></div>
 <div class="gameCol" id="r1c5"></div>
 <div class="gameCol" id="r1c6"></div>
 <div class="gameCol" id="r1c7"></div>
</div>
<div class="gameRow">
 <div class="gameCol" id="r2c0"></div>
 <div class="gameCol" id="r2c1"></div>
 <div class="gameCol" id="r2c2"></div>
 <div class="gameCol" id="r2c3"></div>
 <div class="gameCol" id="r2c4"></div>
 <div class="gameCol" id="r2c5"></div>
 <div class="gameCol" id="r2c6"></div>
 <div class="gameCol" id="r2c7"></div>
</div>
<div class="gameRow">
 <div class="gameCol" id="r3c0"></div>
 <div class="gameCol" id="r3c1"></div>
 <div class="gameCol" id="r3c2"></div>
 <div class="gameCol" id="r3c3"></div>
 <div class="gameCol" id="r3c4"></div>
 <div class="gameCol" id="r3c5"></div>
 <div class="gameCol" id="r3c6"></div>
 <div class="gameCol" id="r3c7"></div>
</div>
<div class="gameRow">
 <div class="gameCol" id="r4c0"></div>
 <div class="gameCol" id="r4c1"></div>
 <div class="gameCol" id="r4c2"></div>
 <div class="gameCol" id="r4c3"></div>
 <div class="gameCol" id="r4c4"></div>
 <div class="gameCol" id="r4c5"></div>
 <div class="gameCol" id="r4c6"></div>
 <div class="gameCol" id="r4c7"></div>
</div>
<div class="gameRow">
 <div class="gameCol" id="r5c0"></div>
 <div class="gameCol" id="r5c1"></div>
 <div class="gameCol" id="r5c2"></div>
 <div class="gameCol" id="r5c3"></div>
 <div class="gameCol" id="r5c4"></div>
 <div class="gameCol" id="r5c5"></div>
 <div class="gameCol" id="r5c6"></div>
 <div class="gameCol" id="r5c7"></div>
</div>
<div class="gameRow">
 <div class="gameCol" id="r6c0"></div>
 <div class="gameCol" id="r6c1"></div>
 <div class="gameCol" id="r6c2"></div>
 <div class="gameCol" id="r6c3"></div>
 <div class="gameCol" id="r6c4"></div>
 <div class="gameCol" id="r6c5"></div>
 <div class="gameCol" id="r6c6"></div>
 <div class="gameCol" id="r6c7"></div>
</div>
<div class="gameRow">
 <div class="gameCol" id="r7c0"></div>
 <div class="gameCol" id="r7c1"></div>
 <div class="gameCol" id="r7c2"></div>
 <div class="gameCol" id="r7c3"></div>
 <div class="gameCol" id="r7c4"></div>
 <div class="gameCol" id="r7c5"></div>
 <div class="gameCol" id="r7c6"></div>
 <div class="gameCol" id="r7c7"></div>
</div>

</div>

<script type="text/javascript">

let horizontalPosition=-1
let verticalPosition=-1
let movingRight=false
let movingDown=false
let movingLeft=false
let movingUp=false

let snakePositions=[ [1,0],[0,0] ] // [row, col]

function setCell() {
 document.getElementById('r'+ verticalPosition+'c'+ horizontalPosition).style['border']='1px solid #ddd'
}

function resetCell() {
 document.getElementById('r'+verticalPosition+'c'+horizontalPosition).style['border']='1px solid #eee'
}

function drawInitial() {
 for(let i=0; i<snakePositions.length;i++) {
  horizontalPosition=snakePositions[i][0]
  verticalPosition=snakePositions[i][1]
  setCell()
 }
}

function runGame() {

setTimeout(()=>{

let head=snakePositions[0]

if(movingRight) {
 horizontalPosition=head[0]+1
 verticalPosition=head[1]
 if(horizontalPosition>7) horizontalPosition=0
} else if(movingDown) {
 horizontalPosition=head[0]
 verticalPosition=head[1]+1
 if(verticalPosition>7) verticalPosition=0 
} else if(movingLeft) {
 horizontalPosition=head[0]-1
 verticalPosition=head[1]
 if(horizontalPosition<0) horizontalPosition=7
} else if(movingUp) {
 horizontalPosition=head[0]
 verticalPosition=head[1]-1
 if(verticalPosition<0) verticalPosition=7
}

 setCell()
 snakePositions.unshift([horizontalPosition,verticalPosition])
if(head.toString()==foodPosition.toString()) {
 positionFood()
} else {
 let tail=snakePositions.pop()
 horizontalPosition=tail[0]
 verticalPosition=tail[1]
 resetCell()
}

runGame()

},1000)

/*if(movingRight) {
 console.log('moveRight ' + horizontalPosition + '  ' + verticalPosition)
 ++horizontalPosition
 setCell()
 setTimeout(()=>{
  resetCell()
  if(horizontalPosition==7) horizontalPosition=-1
  runGame()
 },1000)
} else if(movingLeft) {
 console.log('moveLeft ' + horizontalPosition + '  ' + verticalPosition)
 if(horizontalPosition==0) horizontalPosition=8
 --horizontalPosition
 setCell()
 setTimeout(()=>{
  resetCell()
  runGame()
 },1000)
} else if(movingDown) {
 console.log('moveDown ' + horizontalPosition + '  ' + verticalPosition)
 ++verticalPosition
 setCell()
 setTimeout(()=>{
  resetCell()
  if(verticalPosition==7) verticalPosition=-1
  runGame()
 },1000)
} else if(movingUp) {
 console.log('moveUp ' + horizontalPosition + '  ' + verticalPosition)
 if(verticalPosition==0) verticalPosition=8
 --verticalPosition
 setCell()
 setTimeout(()=>{
  resetCell()
  runGame()
 },1000)
}*/

} // runGame

let foodPosition=[]

function positionFood() {
 foodPosition[0]=~~(Math.random()*8)
 foodPosition[1]=~~(Math.random()*8)
 if(!snakePosition.some(e=>e[0]==foodPosition[0]||e[1]==foodPosition[1])
  document.getElementById('r'+ foodPosition[1]+'c'+ foodPosition[0]).style['border']='1px solid #fff'
 else
   positionFood()
}

verticalPosition=0
movingRight=true
drawInitial()
positionFood()
runGame()

let downKeys=['ArrowDown', 'j']
let upKeys=['ArrowUp', 'k']
let leftKeys=['ArrowLeft', 'h']
let rightKeys=['ArrowRight', 'l']

document.onkeydown = key => {
 if(downKeys.includes(key.key) && !movingDown && !movingUp) {
  movingRight=movingLeft=movingUp=false
  movingDown=true
 }
 if(rightKeys.includes(key.key) && !movingRight && !movingLeft) {
  movingRight=true
  movingDown=movingLeft=movingUp=false
 }
 if(leftKeys.includes(key.key) && !movingRight && !movingLeft) {
  movingLeft=true
  movingDown=movingRight=movingUp=false
 }
 if(upKeys.includes(key.key) && !movingDown && !movingUp) {
  movingUp=true
  movingDown=movingRight=movingLeft=false
 }
}

</script>

</body>
</html>